<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title></title>
	<script src="calltracking.v1.min.js"></script>
    </head>
    <body>
        <h1>Пример подмены телефонного номера</h1>
        <p id="tel">
            <span>+375 (17) </span>000-00-00
        </p>
        <p id="tel2">
            <span>+375 (44) </span>000-00-00 
        </p>
        <p id="tel3">
            <span>+375 (29) </span>000-00-00 
        </p>
        <script type="text/javascript">
            /*
             * Инициализация и начало отслеживания источника. Если найдено совпадение, то данные о 
             * источнике записываются в cookie и сохраняются до закрытия вкладки.
             */
            WMNSAPI.track([
                    // Массив utm идентификаторов источников, обязателен хотя-бы один из параметров метки
                    // {
                    //  medium: 'указать метку utm_medium',
                    //  source: 'указать метку utm_source',
                    //  campaign: 'указать метку utm_campaign',
                    //  term: 'указать метку utm_term',
                    //  campaign: 'указать метку utm_campaign',
                    //  
                    //  ...
                    //  любые праметры, которые будут переданы в функцию обратного вызова
                    //  
                    // }
                    
                    // Пример: по всем органическому трафику будут подставляться номера
                    {medium: 'organic', velcom: '375440000001',pstn: '375171000001'},
                    // Пример: телефонные номера, для источника контекстная реклама Яндекс Директ.
                    {medium: 'cpc',source: 'yandex',velcom: '375440000002',pstn: '375171000002'},
                ],
                    // Функция обратного вызова, которая будет выполнена, в случае нахождения соотвествия между 
                    // параметами из массива utm меток и переходом пользователя на сайте.
                function(tracker,utmz){
                    /**
                     * tracker - объект из массива utm меток
                     * utmz - разобранные метки из источника перехода пользователя
                     */
                    
                    // Заменяет содержимое элемента и id='tel'
                    this.html('#tel',
                        // Форматирует номер, согласно шаблону {{смещение:количество_символов}}
                        // {{0:3}} - выбирает первые три цифры номера tracker.pstn (Пример: 375171000001), результат 375
                        // {{3:2}} - выбирает 4 и 5 цифру номера tracker.pstn, результат 17
                        // {{5:3}} - результат 100
                        // {{8:2}} - результат 00
                        // {{10:2}} - результат 01
                        this.format('<span>+{{0:3}} ({{3:2}}) </span>{{5:3}}-{{8:2}}-{{10:2}}',tracker.pstn));
                    this.html('#tel2',
                        this.format('<span>+{{0:3}} ({{3:2}}) </span>{{5:3}}-{{8:2}}-{{10:2}}',tracker.velco));
                    // Спрятать элемент с id="tel3"    
                    this.display('#tel3',false);
                });
        </script>
    </body>
</html>
